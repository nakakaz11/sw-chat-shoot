// Generated by CoffeeScript 1.4.0

//$(function() {
  //socket.ioのインスタンスもportを指定しちゃだめ。
  //var socket = new io.Socket(null, { port: port });
/*
  var socket = new io.Socket();
  socket.connect();
  socket.on("connect", function() {
    return console.log("connect");
  });
  socket.on("message", function(msg) {
    var date;
    date = new Date();
    return $("#list").prepend($("<dt>" + date + "</dt><dd>" + msg + "</dd>"));
  });
  socket.on("disconnect", function() {
    return console.log("disconnect");
  });
  return $("#form").submit(function() {
    var message;
    message = $("#message");
    socket.send(message.val());
    message.attr("value", "");
    return false;
  });
*/
$(function() {  // new socket.io
  //socket.ioのインスタンスもportを指定しちゃだめ。
  var socket = io.connect();
  //サーバーが受け取ったメッセージを返して実行する
  socket.on('message:push', function (data) {
    var date = new Date();
    return $("#list").prepend($("<dt>" + date + "</dt><dd>" + data.message + "</dd>"));
  });
  socket.on('message:updateDB', function(data){
 		console.log(data);
 	});

  //サーバーにメッセージを引数にイベントを実行する
  $('button#btn').click(function() {
    var msg = $("input#message").val();
    $("input#message").val("");
    socket.emit('message:send', { message: msg });
  });
});
